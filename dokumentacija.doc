1. Vezbe

--Glavni zadatak je uspostaviti komunikaciju preko fieldbusa

3 vrste komunikacije:
	simpleks- komunikacija u jednom smeru (TV)
	half-duplex- komunikacija u dva smera ali kada salje drugi moze samo da prima(Toki-Voki)
	full-duplex- komunikacija u oba smera istovremeno(Telefon)
	[RS232, RS422, RS485]


--RS485- ekstenzija na jednoj zici ima vise njih koji su prijemnici i predajnici, half dupleks
	
	 Pin-out:

	 RO – Receiver out
	 RE – Receiver enable (enabled when this pin is LOW)
	 DE – Driver enable (enabled when this pin is HIGH)
	 DI – Driver in (the transmitter pin)
	 GND – Ground (0V)
	 A – Connect to pin A of the other 485 IC
	 B – Connect to pin B of the other 485 IC
	 Vcc – Power, in my case +5V
 	 TTL Naponski nivo [0,5]

--RS485- donglica za debagovanje i laksu komunikaciju ima USB ulaz koji moze da ide u linux

--Predefinisani profili ,probati naci biblioteku za rpi



linkovi prve vezbe:
http://www.orbitel.co.rs/sr/proizvod/K57603/konvertor-ttl-rs485
https://ktechnics.com/product/max485-rs-485-ttl-to-rs485-max485csa-converter-module-for-arduino/
https://chat.openai.com/c/0ecd3b31-0373-4a75-af3a-02abe2148aef
https://en.wikipedia.org/wiki/Fieldbus


2.Vezbe

--Danas smo pokusali da nesto vise istrazimo modbus. Modbus je industrijski protokol komunikacije. Ovaj protokol omogućava razmenu informacija između uređaja povezanih u industrijskom okruženju.
  Modbus je razvijen devedesetih godina prošlog veka i postao je široko korišćen standard u industrijskim aplikacijama.	
  Modbus se može koristiti preko serijskih veza (RS-232, RS-485) ili preko Ethernet mreže.
  RS-485 je često preferirana u industrijskim okruženjima zbog svoje otpornosti na buku i sposobnosti za komunikaciju na dužim razdaljinama. Mi cemo raditi putem RS-485 serijske veze.

--Preuzeli smo biblioteku libmodbus.
--Kada smo sklinuli bibloteku, sada zelimo da ispisemo kod za komunikaciju izmedju RPi i RS485 donglice
--Nasli smo i biblioteke za komunikaciju Arduina i RS485 Usba

linkovi druge vezbe:
Arduino i RS485 komunikacija preko protoboarda
**https://circuitdigest.com/microcontroller-projects/rs-485-modbus-serial-communication-with-arduino-as-master** 
Modbus kodovi
https://www.arduinolibraries.info/libraries/modbus-rtu_slave_rs485
Arduino sajt -> linkovi MODBUS
https://docs.arduino.cc/learn/communication/modbus
Arduino sajt -> linkovi RS485
https://www.arduino.cc/reference/en/libraries/arduinors485/
Git arudino RS485
https://github.com/arduino-libraries/ArduinoRS485

      
    • google kw?: RPI i RS485
        ◦ https://forums.raspberrypi.com/viewtopic.php?t=288284
        ◦ https://libmodbus.org/
        ◦ https://github.com/stephane/libmodbus
            ▪ https://github.com/stephane/libmodbus/blob/master/tests/unit-test-server.c
                • RTU over /dev/ttyUSB0
                    ◦ That is Modbus over RS485
                        ▪ TCL is over Ethernet
        ◦ sudo apt install libmodbus-dev
            ▪ dal je to to isto?
          

https://forums.raspberrypi.com/viewtopic.php?t=214692 -> biblioteka koju smo nasli sa ovog sajta



https://www.bing.com/?/ai

3.Vezbe

--Na ovim vezbama smo pronasli vec iskucane biblioteke i .c fajlove. Pull-ovali smo projekat na rpi pa smo dodali biblioteke i .c fajlove u folder modbus. 
  Push-ovali smo ih na git u repozitorijum modbus. Preostaje nam da testiramo fajlove i uspostavimo komunikaciju putem modbus magistrale.

--https://www.modbus.org/






dodatni termin

    • Another place to buy:
		https://malina314.com/proizvod/usb-na-rs485-industrijski-konvertor/
    • lsusb
        ◦ It is CH340
        ◦ Google kw: usb to rs485 ch340 schematic
            ▪ https://i.stack.imgur.com/zBwJr.png
                • https://www.analog.com/media/en/technical-documentation/data-sheets/MAX1487-MAX491.pdf
                • R232 dictate direction?
                    ◦ https://cdn.sparkfun.com/datasheets/Dev/Arduino/Other/CH340DS1.PDF
                    ◦ It is input. Need Reverse Engineering of dongle
    • Google kw: usb to rs485 ch340 sw example
        ◦ https://www.youtube.com/watch?v=-U0k_hnxx8I
    • Google kw: usb to rs485 ch340 C code example
        ◦ https://www.esp32.com/viewtopic.php?t=17485
    • Found how on PC
        ◦ ← google kw?: RPI i RS485
    • How on RPi
        ◦ Find out over Google:
            ▪ Google kw: MAX485 RPi C source code example
        ◦ Find out over SW:
            ▪ Read code of libmodbus
            ▪ modbus-rtu.c: modbus_new_rtu()
                • Maybe use RTS pin to select direction
                    ◦ Depend on HAVE_DECL_TIOCM_RTS
                        ▪ Make simple C app to check if we have this define
                            • +Write Makefile with link flags
                            • Nothing
                    ◦ Compile source code to see what is default
        ◦ Find out over HW:
            ▪ Open dongle and Reverse Engineer where DE and RE goes on CH340 IC
        ◦ Do we have on RPi: sudo apt install libmodbus-dev

